---
# Source: splunk-opentelemetry-collector-for-kafka/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: release-name-splunk-opentelemetry-collector-for-kafka-config
  labels:
    helm.sh/chart: splunk-opentelemetry-collector-for-kafka-0.1.0
    app.kubernetes.io/name: splunk-opentelemetry-collector-for-kafka
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "CURRENT-VERSION"
    app.kubernetes.io/managed-by: Helm
data:
  config.yaml: |
    exporters:
      splunk_hec:
        endpoint: https://127.0.0.1:8088/services/collector
        index: kafka-otel
        insecureSkipVerify: true
        source: soc4kafka
        sourcetype: otel:logs
        splunk_app_name: soc4kafka
        tls:
          insecure_skip_verify: false
        token: ${SPLUNK_HEC_TOKEN_PRIMARY}
    extensions:
      health_check:
        endpoint: 0.0.0.0:13133
    processors:
      batch:
        send_batch_size: 1000
        timeout: 5s
      resourcedetection:
        detectors:
        - system
        system:
          hostname_sources:
          - os
    receivers:
      kafka/kerberos:
        auth:
          kerberos:
            password: ${KAFKA_KAFKA_KERBEROS_KERBEROS_PASSWORD}
        brokers:
        - kafka-broker2:9092
        group_id: soc4kafka-main
        logs:
          encoding: text
          topics:
          - perf2
      kafka/plain:
        auth:
          plain_text:
            password: ${KAFKA_KAFKA_PLAIN_PLAIN_TEXT_PASSWORD}
            username: myuser
        brokers:
        - kafka-broker:9092
        group_id: soc4kafka-main
        logs:
          encoding: text
          topics:
          - perf1
      kafka/sasl:
        auth:
          sasl:
            password: ${KAFKA_KAFKA_SASL_SASL_PASSWORD}
            username: myuser
        brokers:
        - kafka-broker3:9092
        group_id: soc4kafka-main
        logs:
          encoding: text
          topics:
          - perf3
      kafka/sasl_password:
        auth:
          sasl:
            password: kafka-sasl-password
            username: myuser
        brokers:
        - kafka-broker3:9092
        conn_idle_timeout: 15s
        group_id: group1
        logs:
          encoding: text
          topics:
          - perf3
        telemetry:
          metrics:
            kafka_receiver_records_delay:
              enabled: true
    service:
      extensions:
      - health_check
      pipelines:
        logs/base_logs:
          exporters:
          - splunk_hec
          processors:
          - batch
          - resourcedetection
          receivers:
          - kafka/plain
          - kafka/kerberos
          - kafka/sasl
          - kafka/sasl_password
