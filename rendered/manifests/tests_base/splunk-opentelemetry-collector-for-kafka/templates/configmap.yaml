---
# Source: splunk-opentelemetry-collector-for-kafka/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: release-name-splunk-opentelemetry-collector-for-kafka-config
  labels:
    helm.sh/chart: splunk-opentelemetry-collector-for-kafka-0.1.0
    app.kubernetes.io/name: splunk-opentelemetry-collector-for-kafka
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "CURRENT-VERSION"
    app.kubernetes.io/managed-by: Helm
data:
  config.yaml: |
    exporters:
      splunk_hec:
        endpoint: https://127.0.0.1:8088/services/collector
        index: kafka-otel
        insecureSkipVerify: true
        source: soc4kafka
        sourcetype: otel:logs
        splunk_app_name: soc4kafka
        tls:
          insecure_skip_verify: false
        token: ${SPLUNK_HEC_TOKEN_PRIMARY}
      splunk_hec/secondary:
        endpoint: https://127.0.0.1:8088/services/collector
        index: kafka-otel-second
        insecureSkipVerify: true
        source: soc4kafka
        sourcetype: otel:logs
        splunk_app_name: soc4kafka
        tls:
          insecure_skip_verify: false
        token: ${SPLUNK_HEC_TOKEN_SECONDARY}
    extensions:
      health_check:
        endpoint: 0.0.0.0:13133
    processors:
      batch:
        send_batch_size: 1000
        timeout: 5s
      resourcedetection:
        detectors:
        - system
        system:
          hostname_sources:
          - os
    receivers:
      kafka/main:
        brokers:
        - kafka-broker:9092
        group_id: soc4kafka-main1
        logs:
          encoding: text
          topics:
          - perf4
      kafka/secondary:
        brokers:
        - kafka-broker:9092
        group_id: soc4kafka-main2
        logs:
          encoding: text
          topics:
          - perf2
      kafka/third:
        brokers:
        - kafka-broker:9092
        group_id: soc4kafka-main3
        logs:
          encoding: text
          topics:
          - perf3
    service:
      extensions:
      - health_check
      pipelines:
        logs/1:
          exporters:
          - splunk_hec
          processors:
          - batch
          - resourcedetection
          receivers:
          - kafka/main
          - kafka/secondary
        logs/2:
          exporters:
          - splunk_hec/secondary
          processors:
          - batch
          - resourcedetection
          receivers:
          - kafka/third
